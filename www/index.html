<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />      
        <script type="text/javascript" src="js/jquerry.js" ></script>
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
        <!-- <link rel="stylesheet" type="text/css" href="css/index.css" /> -->
        <title>Comtas E</title>
        <script language="JavaScript">                        

            function diaSemana(dias){
                var res ="";
                switch (dias){
                    case 0 :
                        res ="Domingo";
                        break;
                    case 1 :
                        res ="Segunda";
                        break;
                    case 2 :
                        res ="Terça";
                        break;
                    case 3 :
                        res ="Quarta";
                        break;
                    case 4 :
                        res ="Quinta";
                        break;
                    case 5 :
                        res ="Sexta!!! porra";
                        break;
                    case 6 :
                        res ="Sabado";
                        break;
                };

                return res;
            }



            function DataHora(){
                var data = new Date();
                var mes = 1;
                mes += data.getMonth();
                tempo.innerHTML = data.toLocaleString();
                document.getElementById('tempos').value = data.toLocaleString();               
                dia.innerHTML = diaSemana(data.getDay()); 
                setTimeout("DataHora()",1000);
            }

            function removerItem(ids){
                window.localStorage.removeItem(ids.value); 
                loadData();               
            }

            function cadastra(){               

                if (document.getElementById('valor').value != '') {                               
                
                    var valors = new Array(document.getElementById('tempos').value,
                    document.getElementById('valor').value , document.getElementById('grupo').value);      
                    window.localStorage.setItem(document.getElementById('tempos').value, valors);
                    document.getElementById('valor').value = '';
                    loadData(); 
                    alert('Cadastrado');
                };

            }

        </script>
    </head>
    <body onLoad="DataHora()" class="alert-danger">
    <div class="alert alert-success">
      <h3 > <span  id="dia"></span></h3> 
      <h3> <span name="tempo" id="tempo"></span></h3>     
     <input type="hidden" name="tempos" id="tempos" / >   
    </div> 
    <div class="col-lg-12 alert-danger">
    <form role="form" class="ng-pristine">
        <div class="form-group"> 
            <button type="reset" id="res" class="form-control">limpar</button> 
        </div>

        <div class="form-group">  
            <label>Valor</label>
            <input id="valor" type="number" class="form-control" pattern="(\d{3})([\.])(\d{2})">
        </div> 
        <div class="form-group">  
            <label>Categoria</label>
            <select class="form-control" id="grupo">
                <option>Combustivel</option>
                <option>Comida</option>
                <option>Cartão / Credito</option>
                <option>Outros</option>
            </select>
        </div>  
        <div class="form-group">  
            <input type="button" onclick="cadastra()" class="form-control" value="Cadastrar"/>
        </div>
    </form>
    </div>
    <div class="col-lg-12 alert-danger">
        <div class="table-responsive">
            <table class="table table-hover table-striped">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Valor</th>
                        <th>Uso</th>
                        <th>Del</th>
                    </tr>
                </thead>
                <tbody id="storage">
                    
                </tbody>              
            </table>            
        </div>  
        <div class="table-responsive" >
            <table class="table table-hover table-striped">
                <thead>
                    <tr>
                        <th>Combus</th>
                        <th>Comida</th>
                        <th>Cartão</th>
                        <th>Outros</th>
                    </tr>
                </thead>
                <tbody id="totais">
                    <tr>
                        <td id="comb"></td>
                        <td id="comi"></td>
                        <td id="cart"></td>
                        <td id="outr"></td>                        
                    </tr>                    
                </tbody>              
            </table>            
        </div>      
    </div > 
    <script type="text/javascript">

    var X = window.localStorage.length;
    var arr = [];
    var dias = [];
    var add;
    var comida=0;
    var cartao=0;
    var Combustivel=0;
    var Outros=0;


    for (var i = 0; i < X; i++) {

        var chave = window.localStorage.key(i);

        arr = window.localStorage.getItem(chave);
        arr = arr.split(",");
        dias = arr[0].split(" ");
        console.log(dias[0] +' - '+arr[1]+' - '+ arr[2]);

          switch (arr[2]){
                    case "Combustivel" :
                        Combustivel = Combustivel+parseFloat(arr[1]);
                        break;
                    case "Comida" :
                        comida = comida+parseFloat(arr[1]);
                        break;
                    case "Cartão / Credito" :
                        cartao = cartao+parseFloat(arr[1]);
                        break;
                    case "Outros" :
                        Outros = Outros+parseFloat(arr[1]);
                        break;         
                };

        add = '<tr>';
        add += '<td>'+dias[0]+'</td>';
        add += '<td>'+arr[1]+'</td>';
        add += '<td>'+arr[2]+'</td>';
        add += '<td><button class="btn btn-lg btn-default" value="'+chave+'" onclick="removerItem(this)"></button></td>';

        storage.innerHTML += add+'</tr>';

    }

    comb.innerHTML = Combustivel;
    comi.innerHTML = comida;
    cart.innerHTML = cartao;
    outr.innerHTML = Outros; 
    
    function loadData(){

        var X = window.localStorage.length;
        var arr = [];
        var dias = [];
        var add;
        var comida=0;
        var cartao=0;
        var Combustivel=0;
        var Outros=0;
       
        for (var i = 0; i < X; i++) {

            var chave = window.localStorage.key(i);

            arr = window.localStorage.getItem(chave);
            arr = arr.split(",");
            dias = arr[0].split(" ");
            console.log(dias[0] +' - '+arr[1]+' - '+ arr[2]);

            switch (arr[2]){
                case "Combustivel" :
                    Combustivel = Combustivel+parseFloat(arr[1]);
                    break;
                case "Comida" :
                    comida = comida+parseFloat(arr[1]);
                    break;
                case "Cartão / Credito" :
                    cartao = cartao+parseFloat(arr[1]);
                    break;
                case "Outros" :
                    Outros = Outros+parseFloat(arr[1]);
                    break;         
            };

            add += '<tr>';
            add += '<td>'+dias[0]+'</td>';
            add += '<td>'+arr[1]+'</td>';
            add += '<td>'+arr[2]+'</td>';
            add += '<td><button class="btn btn-lg btn-default" value="'+chave+'" onclick="removerItem(this)"></button></td>';

            add += '</tr>';
            
        };

        storage.innerHTML = add; 
        comb.innerHTML = Combustivel;
        comi.innerHTML = comida;
        cart.innerHTML = cartao;
        outr.innerHTML = Outros;  
    } 

    </script>
    </body>
</html>
